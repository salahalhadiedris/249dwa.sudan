{% extends "base.html" %}
{% load static %}

{% block content %}

<h2>قائمة المنتجات</h2>

<form method="get" class="mb-3">
  <select name="category" onchange="this.form.submit()">
    <option value="">كل الفئات</option>
    {% for cat in categories %}
      <option value="{{ cat.id }}" {% if request.GET.category == cat.id|stringformat:"s" %}selected{% endif %}>
        {{ cat.name }}
      </option>
    {% endfor %}
  </select>
</form>

<hr>

{% for product in products %}
  <div class="border rounded p-2 mb-2">
    <strong>{{ product.name }}</strong> — {{ product.category.name }} — {{ product.price }} جنيه
    <br>
    <small>الصيدليات المتوفر فيها:</small>
    <ul>
      {% for ph in product.pharmacies.all %}
        <li>{{ ph.name }} ({{ ph.city }})</li>
      {% endfor %}
    </ul>
  </div>
{% empty %}
  <p>مافي منتجات مطابقة.</p>
{% endfor %}


{% endblock %}